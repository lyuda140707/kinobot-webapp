<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KinoBot Web App</title>

  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: #111;
      color: #fff;
    }
    .section {
      display: none;
      padding: 20px;
      
    }
    .active {
      display: block;
    }
    .nav {
  position: fixed;
  bottom: 0;
  width: 100%;
  background: linear-gradient(to right, #0f2027, #203a43, #2c5364); /* Ğ³Ñ€Ğ°Ğ´Ñ–Ñ”Ğ½Ñ‚ */
  display: flex;
  justify-content: space-around;
  padding: 10px 0 6px;
  border-top: 1px solid #333;
  z-index: 999;
  box-shadow: 0 -2px 10px rgba(0, 255, 255, 0.15);
}

.nav button {
  background: none;
  border: none;
  color: #aaa;
  font-size: 20px;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 8px 10px;
  transition: all 0.2s ease-in-out;
  position: relative;
}

.nav button span {
  margin-top: 4px;
  font-size: 14px;
}


.nav button.active {
  color: #00f7ff;
  text-shadow: 0 0 6px #00f7ff;
  transform: scale(1.1);
}

.nav button.active::after {
  content: '';
  position: absolute;
  bottom: -3px;
  left: 50%;
  transform: translateX(-50%);
  width: 36%;
  height: 3px;
  border-radius: 3px;
  background: #00f7ff;
  box-shadow: 0 0 8px #00f7ff;
}


 
  .loader {
    border: 4px solid #444;
    border-top: 4px solid #fff;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
    display: inline-block;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>

  
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap" rel="stylesheet">


</head>
<body>

   <div id="home" class="section active" style="padding: 20px;">
  <h2 style="margin-bottom: 10px;">ğŸ¬ Ğ¤Ñ–Ğ»ÑŒĞ¼ Ğ´Ğ½Ñ</h2>  
  <div id="film-of-the-day" class="film-day-card">
    <img id="film-img" src="" alt="" />
    <div class="film-title-overlay" id="film-title">ĞĞ°Ğ·Ğ²Ğ°</div>
    <button class="film-day-button" onclick="searchInBot('ĞĞ°Ğ·Ğ²Ğ°')">â–¶ï¸ Ğ”Ğ¸Ğ²Ğ¸Ñ‚Ğ¸ÑÑŒ</button>
    <div id="loading-indicator" style="display:none; text-align:center; margin-top:10px; font-size:16px;">
  <span class="loader"></span>
  <div style="margin-top:8px;">Ğ—Ğ°Ñ‡ĞµĞºĞ°Ğ¹Ñ‚Ğµ...</div>
</div>

  </div>






  <div style="margin: 25px 0 10px;">
    <h3>Ğ–Ğ°Ğ½Ñ€Ğ¸</h3>
    <div style="display:flex; flex-wrap:wrap; gap:10px; padding:10px 0;">
      <button class="genre-btn" data-genre="ĞĞ¾Ğ²Ğ¸Ğ½ĞºĞ¸">ĞĞ¾Ğ²Ğ¸Ğ½ĞºĞ¸</button>
      <button class="genre-btn" data-genre="ĞšĞ¾Ğ¼ĞµĞ´Ñ–Ñ—">ĞšĞ¾Ğ¼ĞµĞ´Ñ–Ñ—</button>
      <button class="genre-btn" data-genre="Ğ”Ñ€Ğ°Ğ¼Ğ¸">Ğ”Ñ€Ğ°Ğ¼Ğ¸</button>
      <button class="genre-btn" data-genre="Ğ¡ĞµÑ€Ñ–Ğ°Ğ»Ğ¸">Ğ¡ĞµÑ€Ñ–Ğ°Ğ»Ğ¸</button>
      <button class="genre-btn" data-genre="ĞœÑƒĞ»ÑŒÑ‚Ñ„Ñ–Ğ»ÑŒĞ¼Ğ¸">ĞœÑƒĞ»ÑŒÑ‚Ñ„Ñ–Ğ»ÑŒĞ¼Ğ¸</button>
    </div>
</div>

<div style="margin-top: 25px;">
  <h3>Ğ”Ğ¾Ğ±Ñ–Ñ€ĞºĞ¸</h3>
  <div id="collections" style="display:flex; overflow-x:auto; gap:10px; padding:10px 0;"></div>
</div>


 <!-- ğŸï¸ ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ñ–Ñ— -->
<div id="categories" class="section">
  <h2>ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ñ–Ñ—</h2>
  <button class="back-button" onclick="goToHome()">â¬…ï¸ ĞĞ°Ğ·Ğ°Ğ´</button>

  <div class="genre-main-wrapper">
    <div id="genre-main-buttons" class="genre-main-buttons">
      <button class="genre-main-btn fade-in" data-group="films">ğŸ¯ Ğ—Ğ° Ğ¶Ğ°Ğ½Ñ€Ğ¾Ğ¼</button>
      <button class="genre-main-btn fade-in" data-group="series">ğŸ“º Ğ¡ĞµÑ€Ñ–Ğ°Ğ»Ğ¸</button>
      <button class="genre-main-btn fade-in" data-group="cartoons">ğŸ‘§ ĞœÑƒĞ»ÑŒÑ‚Ğ¸ĞºĞ¸</button>

    </div>
  </div>
  
<!-- ğŸ”½ ĞŸÑ–Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ñ–Ñ—: Ğ—Ğ° Ğ¶Ğ°Ğ½Ñ€Ğ¾Ğ¼ -->
<div id="group-films" class="genre-button-container genre-scroll" style="display:none; margin-top:20px;">
  <button class="genre-btn" data-genre="Ğ•ĞºÑˆĞ½(Ğ±Ğ¾Ğ¹Ğ¾Ğ²Ğ¸ĞºĞ¸)">ğŸ”« Ğ•ĞºÑˆĞ½</button>
  <button class="genre-btn" data-genre="ĞšĞ¾Ğ¼ĞµĞ´Ñ–Ñ—">ğŸ˜‚ ĞšĞ¾Ğ¼ĞµĞ´Ñ–Ñ—</button>
  <button class="genre-btn" data-genre="Ğ”ĞµÑ‚ĞµĞºÑ‚Ğ¸Ğ²Ğ¸">ğŸ•µï¸ Ğ”ĞµÑ‚ĞµĞºÑ‚Ğ¸Ğ²Ğ¸</button>
  <button class="genre-btn" data-genre="Ğ”Ñ€Ğ°Ğ¼Ğ¸">ğŸ­ Ğ”Ñ€Ğ°Ğ¼Ğ¸</button>
  <button class="genre-btn" data-genre="Ğ’Ñ–Ğ¹ÑÑŒĞºĞ¾Ğ²Ñ–">ğŸª– Ğ’Ñ–Ğ¹ÑÑŒĞºĞ¾Ğ²Ñ–</button>
  <button class="genre-btn" data-genre="Ğ¤Ğ°Ğ½Ñ‚Ğ°ÑÑ‚Ğ¸ĞºĞ°">ğŸ‘½ Ğ¤Ğ°Ğ½Ñ‚Ğ°ÑÑ‚Ğ¸ĞºĞ°</button>
  <button class="genre-btn" data-genre="Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ»ÑŒĞ½Ñ–">ğŸ“š Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ»ÑŒĞ½Ñ–</button>
  <button class="genre-btn" data-genre="Ğ¢Ñ€Ğ¸Ğ»ĞµÑ€Ğ¸">ğŸ˜± Ğ¢Ñ€Ğ¸Ğ»ĞµÑ€Ğ¸</button>
  <button class="genre-btn" data-genre="Ğ¡Ñ–Ğ¼ĞµĞ¹Ğ½Ñ–">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Ğ¡Ñ–Ğ¼ĞµĞ¹Ğ½Ñ–</button>
  <button class="genre-btn" data-genre="ĞœĞµĞ»Ğ¾Ğ´Ñ€Ğ°Ğ¼Ğ¸">ğŸ’” ĞœĞµĞ»Ğ¾Ğ´Ñ€Ğ°Ğ¼Ğ¸</button>
  <button class="genre-btn" data-genre="ĞšÑ€Ğ¸Ğ¼Ñ–Ğ½Ğ°Ğ»">ğŸš” ĞšÑ€Ğ¸Ğ¼Ñ–Ğ½Ğ°Ğ»</button>
  <button class="genre-btn" data-genre="Ğ¤ĞµĞ½Ñ‚ĞµĞ·Ñ–">ğŸ§ Ğ¤ĞµĞ½Ñ‚ĞµĞ·Ñ–</button>
  <button class="genre-btn" data-genre="ĞŸÑ€Ğ¸Ğ³Ğ¾Ğ´Ğ¸">ğŸŒ ĞŸÑ€Ğ¸Ğ³Ğ¾Ğ´Ğ¸</button>
  <button class="genre-btn" data-genre="Ğ†ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡Ğ½Ñ–">ğŸ° Ğ†ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡Ğ½Ñ–</button>
  <button class="genre-btn" data-genre="Ğ Ğ¾Ğ¼Ğ°Ğ½Ñ‚Ğ¸Ñ‡Ğ½Ñ–">ğŸ’˜ Ğ Ğ¾Ğ¼Ğ°Ğ½Ñ‚Ğ¸Ñ‡Ğ½Ñ–</button>
  <button class="genre-btn" data-genre="Ğ–Ğ°Ñ…Ğ¸">ğŸ‘» Ğ–Ğ°Ñ…Ğ¸</button>
</div>

<!-- ğŸ”½ ĞŸÑ–Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ñ–Ñ—: Ğ¡ĞµÑ€Ñ–Ğ°Ğ»Ğ¸ -->
<div id="group-series" class="genre-button-container genre-scroll" style="display:none; margin-top:20px;">
  <button class="genre-btn" data-genre="Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºÑ–">ğŸ‡ºğŸ‡¦ Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºÑ–</button>
  <button class="genre-btn" data-genre="Ğ”ĞµÑ‚ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ñ–">ğŸ•µï¸â€â™€ï¸ Ğ”ĞµÑ‚ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ñ–</button>
  <button class="genre-btn" data-genre="Ğ”Ñ€Ğ°Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ñ–">ğŸ­ Ğ”Ñ€Ğ°Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ñ–</button>
  <button class="genre-btn" data-genre="ĞŸÑ€Ğ¸Ğ³Ğ¾Ğ´Ğ½Ğ¸Ñ†ÑŒĞºÑ–">ğŸŒ„ ĞŸÑ€Ğ¸Ğ³Ğ¾Ğ´Ğ½Ğ¸Ñ†ÑŒĞºÑ–</button>
  <button class="genre-btn" data-genre="ĞšĞ¾Ğ¼ĞµĞ´Ñ–Ğ¹Ğ½Ñ–">ğŸ˜‚ ĞšĞ¾Ğ¼ĞµĞ´Ñ–Ğ¹Ğ½Ñ–</button>
  <button class="genre-btn" data-genre="ĞœĞµĞ»Ğ¾Ğ´Ñ€Ğ°Ğ¼Ğ¸">ğŸ’” ĞœĞµĞ»Ğ¾Ğ´Ñ€Ğ°Ğ¼Ğ¸</button>
  <button class="genre-btn" data-genre="Ğ†ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡Ğ½Ñ–">ğŸ° Ğ†ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡Ğ½Ñ–</button>
  <button class="genre-btn" data-genre="Ğ¤Ğ°Ğ½Ñ‚Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ñ–">ğŸ‘½ Ğ¤Ğ°Ğ½Ñ‚Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ñ–</button>
  <button class="genre-btn" data-genre="ĞšÑ€Ğ¸Ğ¼Ñ–Ğ½Ğ°Ğ»ÑŒĞ½Ñ–">ğŸš” ĞšÑ€Ğ¸Ğ¼Ñ–Ğ½Ğ°Ğ»ÑŒĞ½Ñ–</button>
</div>

<!-- ğŸ”½ ĞŸÑ–Ğ´ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ñ–Ñ—: ĞœÑƒĞ»ÑŒÑ‚Ğ¸ĞºĞ¸ -->
<div id="group-cartoons" class="genre-button-container genre-scroll" style="display:none; margin-top:20px;">
  
</div>

  <div id="genre-results" style="margin-top:20px;"></div>
</div>



  <!-- â¤ï¸ Ğ£Ğ»ÑĞ±Ğ»ĞµĞ½Ğµ -->
<div id="favorites" class="section">
  <h2>Ğ£Ğ»ÑĞ±Ğ»ĞµĞ½Ğµ</h2>
  <button class="back-button" onclick="goToHome()">â¬…ï¸ ĞĞ°Ğ·Ğ°Ğ´</button>
  <p>Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ·Ğ±ĞµÑ€ĞµĞ¶ĞµĞ½Ğ¸Ñ… Ñ„Ñ–Ğ»ÑŒĞ¼Ñ–Ğ²...</p>
</div>

  <!-- ğŸ” ĞŸĞ¾ÑˆÑƒĞº -->
  <div id="search" class="section">
  <h2>ĞŸĞ¾ÑˆÑƒĞº</h2>
  <button class="back-button" onclick="goToHome()">â¬…ï¸ ĞĞ°Ğ·Ğ°Ğ´</button>
    <input
      type="text"
      id="searchInput"
      placeholder="Ğ’Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ Ğ½Ğ°Ğ·Ğ²Ñƒ Ğ°Ğ±Ğ¾ Ğ¶Ğ°Ğ½Ñ€..."
      style="width:100%;padding:10px;"
      oninput="searchFilms()"
    />
    <div id="searchResults" style="margin-top: 20px;"></div>
  </div>
  

  <!-- ĞœĞµĞ½Ñ Ğ½Ğ°Ğ²Ñ–Ğ³Ğ°Ñ†Ñ–Ñ— -->
<div class="nav">
  <button class="nav-btn active" data-tab="home">ğŸ <span>Ğ“Ğ¾Ğ»Ğ¾Ğ²Ğ½Ğ°</span></button>
  <button class="nav-btn" data-tab="categories">ğŸï¸<span>ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ñ–Ñ—</span></button>
  <button class="nav-btn" data-tab="favorites">ğŸ’›<span>Ğ£Ğ»ÑĞ±Ğ»ĞµĞ½Ğµ</span></button>
  <button class="nav-btn" data-tab="search">ğŸ”<span>ĞŸĞ¾ÑˆÑƒĞº</span></button>
</div>


  <script>
 
    let films = [];
  
    async function loadFilms() {
  const res = await fetch('https://opensheet.vercel.app/1LlkMITwr1sXyQI_jmfhrhEPXB2L22MCh8GIXNm5aoTQ/Sheet1');
  films = await res.json();

  const collections = [...new Set(films.map(f => f['Ğ”Ğ¾Ğ±Ñ–Ñ€ĞºĞ°']).filter(Boolean))];
  showCollections(collections);

  showFilmOfTheDay();
}

    
    
   function switchTab(tabId, btn = null) {
  document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
  document.getElementById(tabId).classList.add('active');

  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));

  if (btn) {
    btn.classList.add('active');
  }

  if (tabId === 'favorites') {
    showFavorites();
  }
}


    window.addEventListener('DOMContentLoaded', () => {
  window.Telegram.WebApp.ready();
 
        // ĞŸÑ€Ğ¸Ğ²Ê¼ÑĞ·ĞºĞ° Ğ¶Ğ°Ğ½Ñ€Ñ–Ğ² Ñƒ "Ğ¤Ñ–Ğ»ÑŒĞ¼ Ğ´Ğ½Ñ"
  document.querySelectorAll('.genre-btn').forEach(btn => {
    const genre = btn.dataset.genre;
    if (genre) {
      btn.addEventListener('click', () => {
        // ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ¸Ñ‚Ğ¸ Ğ½Ğ° Ğ²ĞºĞ»Ğ°Ğ´ĞºÑƒ "ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ñ–Ñ—"
        switchTab('categories', document.querySelector('[data-tab="categories"]'));
        // Ğ’Ğ¸ĞºĞ»Ğ¸ĞºĞ°Ñ‚Ğ¸ Ñ„Ñ–Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ñ–Ñ
        filterByGenre(genre);
      });
    }
  });


  // âœ… ĞŸÑ€Ğ¸Ğ²â€™ÑĞ·ĞºĞ° ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº "Ğ—Ğ° Ğ¶Ğ°Ğ½Ñ€Ğ¾Ğ¼", "Ğ¡ĞµÑ€Ñ–Ğ°Ğ»Ğ¸", "ĞœÑƒĞ»ÑŒÑ‚Ğ¸ĞºĞ¸"
  document.querySelectorAll('.genre-main-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const group = btn.dataset.group;

    // Ğ—Ğ½ÑÑ‚Ğ¸ ĞºĞ»Ğ°Ñ active Ğ· ÑƒÑÑ–Ñ…
    document.querySelectorAll('.genre-main-btn').forEach(b => b.classList.remove('active'));

    // Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¸Ğ¹ ĞºĞ»Ğ°Ñ Ğ´Ğ¾ Ğ½Ğ°Ñ‚Ğ¸ÑĞ½ÑƒÑ‚Ğ¾Ñ—
    btn.classList.add('active');

    // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚Ğ¸ Ğ²Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ½Ñƒ Ğ³Ñ€ÑƒĞ¿Ñƒ
    openGenreGroup(group);
  });
});

 
      
  // âœ… ĞŸÑ€Ğ¸Ğ²â€™ÑĞ·ĞºĞ° ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº Ğ½Ğ¸Ğ¶Ğ½ÑŒĞ¾Ğ³Ğ¾ Ğ¼ĞµĞ½Ñ
  document.querySelectorAll('.nav-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const tabId = btn.dataset.tab;
      switchTab(tabId, btn);
    });
  });

});


    function addToFavorites(title, description) {
      const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
      favorites.push({ title, description });
      localStorage.setItem('favorites', JSON.stringify(favorites));
      alert('Ğ”Ğ¾Ğ´Ğ°Ğ½Ğ¾ Ğ² ÑƒĞ»ÑĞ±Ğ»ĞµĞ½Ğµ ğŸ’›');
    }
  
    function showFavorites() {
  const container = document.getElementById('favorites');
  const favorites = JSON.parse(localStorage.getItem('favorites')) || [];

  let html = `
    <h2>Ğ£Ğ»ÑĞ±Ğ»ĞµĞ½Ğµ</h2>
    <button class="back-button" onclick="goToHome()">â¬…ï¸ ĞĞ°Ğ·Ğ°Ğ´</button>
  `;

  if (favorites.length === 0) {
    html += '<p>ĞÑ–Ñ‡Ğ¾Ğ³Ğ¾ Ğ½Ğµ Ğ·Ğ±ĞµÑ€ĞµĞ¶ĞµĞ½Ğ¾ ğŸ˜¢</p>';
  } else {
    favorites.forEach(item => {
      html += `
        <div style="background:#1c1c1c; padding:10px; margin-bottom:10px; border-radius:8px;">
          <h3>${item.title}</h3>
          <p>${item.description}</p>
        </div>
      `;
    });
  }

  container.innerHTML = html;
}



    function filterByGenre(genre) {
  const container = document.getElementById('genre-results');
  container.innerHTML = `<h3 style="margin-top:10px;">ğŸ¬ ${genre}</h3>`;

  let filtered;

  if (genre === 'ĞĞ¾Ğ²Ğ¸Ğ½ĞºĞ¸') {
    // Ğ‘ĞµÑ€ĞµĞ¼Ğ¾ Ğ¾ÑÑ‚Ğ°Ğ½Ğ½Ñ– 10 Ñ„Ñ–Ğ»ÑŒĞ¼Ñ–Ğ²
    filtered = films.slice(-10).reverse(); // Ğ¾ÑÑ‚Ğ°Ğ½Ğ½Ñ–, Ñƒ Ğ·Ğ²Ğ¾Ñ€Ğ¾Ñ‚Ğ½Ğ¾Ğ¼Ñƒ Ğ¿Ğ¾Ñ€ÑĞ´ĞºÑƒ
  } else {
    filtered = films.filter(film =>
      film['Ğ–Ğ°Ğ½Ñ€']?.toLowerCase().includes(genre.toLowerCase())
    );
  }

  if (filtered.length === 0) {
    container.innerHTML += `<p>ĞÑ–Ñ‡Ğ¾Ğ³Ğ¾ Ğ½Ğµ Ğ·Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ ğŸ˜¢</p>`;
    return;
  }

  container.innerHTML += filtered.map(film => `
    <div style="
      background: linear-gradient(145deg, #1c1c1c, #2c2c2c);
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
    ">
      <img src="${film['Ğ¤Ğ¾Ñ‚Ğ¾']}" alt="${film['ĞĞ°Ğ·Ğ²Ğ°']}" style="width:100%; border-radius:10px; margin-bottom:15px;">
      <h3 style="margin-bottom:5px;">${film['ĞĞ°Ğ·Ğ²Ğ°']}</h3>
      <p style="opacity:0.85;">${film['ĞĞ¿Ğ¸Ñ']}</p>
      <button class="search-button" data-query="${film['ĞĞ°Ğ·Ğ²Ğ°'].replace(/'/g, "\\'")}"
        style="margin-top:12px; background:#e50914; color:#fff; padding:10px 20px; border-radius:8px; border:none; cursor:pointer; font-weight:bold;">
        â–¶ï¸ Ğ”Ğ¸Ğ²Ğ¸Ñ‚Ğ¸ÑÑŒ
      </button>
    </div>
  `).join('');

    container.querySelectorAll('.search-button').forEach(button => {
    button.addEventListener('click', () => {
      const query = button.getAttribute('data-query');
      handleSearchWithSpinner(button, query);
    });
  });
}


function getFilmsByCollection(collectionName) {
  const container = document.getElementById('genre-results');
  container.innerHTML = `<h3 style="margin-top:10px;">ğŸ¯ Ğ”Ğ¾Ğ±Ñ–Ñ€ĞºĞ°: ${collectionName}</h3>`;

  const filtered = films.filter(film =>
    film['Ğ”Ğ¾Ğ±Ñ–Ñ€ĞºĞ°']?.toLowerCase().includes(collectionName.toLowerCase())
  );

  if (filtered.length === 0) {
    container.innerHTML += '<p>ĞÑ–Ñ‡Ğ¾Ğ³Ğ¾ Ğ½Ğµ Ğ·Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ ğŸ˜¢</p>';
    switchTab('categories', document.querySelector('[data-tab="categories"]'));
    return;
  }

  container.innerHTML += filtered.map(film => `
    <div style="
      background: linear-gradient(145deg, #1c1c1c, #2c2c2c);
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
    ">
      <img src="${film['Ğ¤Ğ¾Ñ‚Ğ¾']}" alt="${film['ĞĞ°Ğ·Ğ²Ğ°']}" style="width:100%; border-radius:10px; margin-bottom:15px;">
      <h3 style="margin-bottom:5px;">${film['ĞĞ°Ğ·Ğ²Ğ°']}</h3>
      <p style="opacity:0.85;">${film['ĞĞ¿Ğ¸Ñ']}</p>
      <button class="search-button" data-query="${film['ĞĞ°Ğ·Ğ²Ğ°'].replace(/'/g, "\\'")}"
        style="margin-top:12px; background:#e50914; color:#fff; padding:10px 20px; border-radius:8px; border:none; cursor:pointer; font-weight:bold;">
        â–¶ï¸ Ğ”Ğ¸Ğ²Ğ¸Ñ‚Ğ¸ÑÑŒ
      </button>
    </div>
  `).join('');

  // Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ğ¾Ğ±Ñ€Ğ¾Ğ±ĞºÑƒ ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº
  container.querySelectorAll('.search-button').forEach(button => {
    button.addEventListener('click', () => {
      const query = button.getAttribute('data-query');
      handleSearchWithSpinner(button, query);
    });
  });

  // ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¸Ñ‚Ğ¸ Ñƒ Ğ²ĞºĞ»Ğ°Ğ´ĞºÑƒ ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ñ–Ñ—
  switchTab('categories', document.querySelector('[data-tab="categories"]'));
}

  
   function searchFilms() {
  const query = document.getElementById('searchInput').value.toLowerCase();
  const results = films.filter(film =>
    film['ĞĞ°Ğ·Ğ²Ğ°'].toLowerCase().includes(query) ||
    film['Ğ–Ğ°Ğ½Ñ€'].toLowerCase().includes(query) ||
    film['ĞĞ¿Ğ¸Ñ'].toLowerCase().includes(query)
  );

  const container = document.getElementById('searchResults');
  if (results.length === 0) {
    container.innerHTML = '<p>ĞÑ–Ñ‡Ğ¾Ğ³Ğ¾ Ğ½Ğµ Ğ·Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ ğŸ˜¢</p>';
    return;
  }

  container.innerHTML = results.map(film => `
    <div style="background:#1c1c1c; padding:10px; margin-bottom:20px; border-radius:10px;">
      <img src="${film['Ğ¤Ğ¾Ñ‚Ğ¾']}" alt="${film['ĞĞ°Ğ·Ğ²Ğ°']}" style="max-width:100%; height:auto; border-radius:10px; margin-bottom:10px;">
      <h3>${film['ĞĞ°Ğ·Ğ²Ğ°']}</h3>
      <p>${film['ĞĞ¿Ğ¸Ñ']}</p>
      <button class="search-button" data-query="${film['ĞĞ°Ğ·Ğ²Ğ°'].replace(/'/g, "\\'")}"
        style="display:inline-block; background:#e50914; color:#fff; padding:10px 20px; border-radius:5px; border:none; cursor:pointer; margin-top:10px;">
        â–¶ï¸ Ğ”Ğ¸Ğ²Ğ¸Ñ‚Ğ¸ÑÑŒ
      
      </button>
    </div>
  `).join('');

  // â¬‡ï¸ Ğ¾Ğ±Ğ¾Ğ²Ê¼ÑĞ·ĞºĞ¾Ğ²Ğ¾ Ğ¿Ñ–ÑĞ»Ñ Ğ²ÑÑ‚Ğ°Ğ²ĞºĞ¸ ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº
  container.querySelectorAll('.search-button').forEach(button => {
    button.addEventListener('click', () => {
      const query = button.getAttribute('data-query');
      handleSearchWithSpinner(button, query);
    });
  });
}


      // Ğ¥Ğ¾Ğ²Ğ°Ñ‚Ğ¸ ĞºĞ»Ğ°Ğ²Ñ–Ğ°Ñ‚ÑƒÑ€Ñƒ Ğ¿Ñ€Ğ¸ Ğ½Ğ°Ñ‚Ğ¸ÑĞºĞ°Ğ½Ğ½Ñ– Ğ½Ğ° Ğ±ÑƒĞ´ÑŒ-Ñ‰Ğ¾, ĞºÑ€Ñ–Ğ¼ input
  document.addEventListener('click', (e) => {
    if (e.target.tagName !== 'INPUT') {
      const active = document.activeElement;
      if (active && typeof active.blur === 'function') {
        active.blur();
      }
    }
  });

  // Ğ¥Ğ¾Ğ²Ğ°Ñ‚Ğ¸ ĞºĞ»Ğ°Ğ²Ñ–Ğ°Ñ‚ÑƒÑ€Ñƒ Ğ¿Ñ€Ğ¸ Enter Ñƒ Ğ¿Ğ¾Ğ»Ñ– Ğ¿Ğ¾ÑˆÑƒĞºÑƒ
  document.getElementById('searchInput').addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      e.preventDefault();
      e.target.blur();
    }
  });
async function searchInBot(query) {
  const tg = window.Telegram.WebApp;
  const user = tg.initDataUnsafe?.user;

  if (!user) {
    alert("â—ï¸ĞĞµ Ğ²Ğ´Ğ°Ğ»Ğ¾ÑÑ Ğ¾Ñ‚Ñ€Ğ¸Ğ¼Ğ°Ñ‚Ğ¸ Telegram ID");
    return;
  }

  const user_id = user.id;
  const backendUrl = "https://kinobot-qm9q.onrender.com/search-in-bot";

  // ğŸ”½ ĞŸĞĞšĞĞ—ĞĞ¢Ğ˜ Ğ¡ĞŸĞ†ĞĞ•Ğ 
  document.getElementById("loading-indicator").style.display = "block";

  try {
    const res = await fetch(backendUrl, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ user_id, query }),
    });

    const data = await res.json();
    console.log("ğŸ“¥ Ğ’Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´ÑŒ Ğ²Ñ–Ğ´ ÑĞµÑ€Ğ²ĞµÑ€Ğ°:", data);

    if (data.found && data.videoUrl) {
      window.location.href = data.videoUrl;
    } else {
      alert("Ğ¤Ñ–Ğ»ÑŒĞ¼ Ğ½Ğµ Ğ·Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ ğŸ˜¢");
    }
  } catch (err) {
    alert("Ğ¡Ñ‚Ğ°Ğ»Ğ°ÑÑ Ğ¿Ğ¾Ğ¼Ğ¸Ğ»ĞºĞ° ğŸ˜¢");
    console.error(err);
  } finally {
    // ğŸ”½ Ğ¡Ğ¥ĞĞ’ĞĞ¢Ğ˜ Ğ¡ĞŸĞ†ĞĞ•Ğ 
    document.getElementById("loading-indicator").style.display = "none";
  }
}


  function openGenreGroup(group) {
  // Ğ¡Ñ…Ğ¾Ğ²Ğ°Ñ‚Ğ¸ Ğ²ÑÑ– Ğ³Ñ€ÑƒĞ¿Ğ¸
  document.getElementById("group-films").style.display = "none";
  document.getElementById("group-series").style.display = "none";
  const cartoonsGroup = document.getElementById("group-cartoons");
if (cartoonsGroup) {
  cartoonsGroup.style.display = "none";
}


  // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚Ğ¸ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñƒ
  document.getElementById(`group-${group}`).style.display = "flex";
}

    function showFilmOfTheDay() {
  if (!films.length) return;

  const todayKey = new Date().toDateString();
  const stored = JSON.parse(localStorage.getItem("filmOfTheDay"));

  let film;
  if (stored && stored.date === todayKey) {
    film = stored.film;
  } else {
    film = films[Math.floor(Math.random() * films.length)];
    localStorage.setItem("filmOfTheDay", JSON.stringify({ date: todayKey, film }));
  }

  document.getElementById("film-img").src = film['Ğ¤Ğ¾Ñ‚Ğ¾'];
  document.getElementById("film-img").alt = film['ĞĞ°Ğ·Ğ²Ğ°'];
  document.getElementById("film-title").textContent = film['ĞĞ°Ğ·Ğ²Ğ°'];

  const button = document.querySelector(".film-day-button");
  if (button) {
    button.setAttribute("onclick", `searchInBot('${film['ĞĞ°Ğ·Ğ²Ğ°'].replace(/'/g, "\\'")}')`);
  }
}

    function showCollections(collections) {
  const container = document.getElementById('collections');
  container.innerHTML = collections.map(name => {
    const example = films.find(f => f['Ğ”Ğ¾Ğ±Ñ–Ñ€ĞºĞ°']?.toLowerCase() === name.toLowerCase());
    return `
      <div class="collection-card" onclick="getFilmsByCollection('${name}')">
        <img src="${example?.Ğ¤Ğ¾Ñ‚Ğ¾ || 'https://via.placeholder.com/150'}" alt="${name}" />
        <p>${name}</p>
      </div>
    `;
  }).join('');
}

function goToHome() {
  switchTab('home', document.querySelector('[data-tab="home"]'));
}

    function handleSearchWithSpinner(button, query) {
  const tg = window.Telegram.WebApp;
  const user = tg.initDataUnsafe?.user;

  if (!user) {
    alert("â—ï¸ĞĞµ Ğ²Ğ´Ğ°Ğ»Ğ¾ÑÑ Ğ¾Ñ‚Ñ€Ğ¸Ğ¼Ğ°Ñ‚Ğ¸ Telegram ID");
    return;
  }

  const user_id = user.id;
  const backendUrl = "https://kinobot-qm9q.onrender.com/search-in-bot";

  button.disabled = true;
  button.innerHTML = `<span class="spinner"></span> Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ...`;

  fetch(backendUrl, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ user_id, query }),
  })
    .then(res => res.json())
    .then(data => {
      if (data.found && data.videoUrl) {
        window.location.href = data.videoUrl;
      } else {
        alert("Ğ¤Ñ–Ğ»ÑŒĞ¼ Ğ½Ğµ Ğ·Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ ğŸ˜¢");
      }
    })
    .catch(err => {
      alert("Ğ¡Ñ‚Ğ°Ğ»Ğ°ÑÑ Ğ¿Ğ¾Ğ¼Ğ¸Ğ»ĞºĞ° ğŸ˜¢");
      console.error(err);
    })
    .finally(() => {
      button.disabled = false;
      button.innerHTML = "â–¶ï¸ Ğ”Ğ¸Ğ²Ğ¸Ñ‚Ğ¸ÑÑŒ";
    });
}
    
// âœ… Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°Ñ”Ğ¼Ğ¾ Ğ·Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ Ñ„Ñ–Ğ»ÑŒĞ¼Ñ–Ğ² Ğ¿Ñ–ÑĞ»Ñ Ğ¾Ğ³Ğ¾Ğ»Ğ¾ÑˆĞµĞ½Ğ½Ñ Ğ²ÑÑ–Ñ… Ñ„ÑƒĞ½ĞºÑ†Ñ–Ğ¹
loadFilms();

document.addEventListener("DOMContentLoaded", () => {
  const scrollBtn = document.getElementById("scrollToTop");

  window.addEventListener("scroll", () => {
    if (window.scrollY > 200) {
      scrollBtn.style.display = "block";
    } else {
      scrollBtn.style.display = "none";
    }
  });

  scrollBtn.addEventListener("click", () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });
});

</script>
  
  <!-- ğŸ” ĞšĞ½Ğ¾Ğ¿ĞºĞ° "Ğ’Ğ³Ğ¾Ñ€Ñƒ" -->
<button id="scrollToTop" style="
  display: none;
  position: fixed;
  bottom: 80px;
  right: 20px;
  width: 52px;
  height: 52px;
  background: radial-gradient(circle at 30% 30%, #00f7ff, #008fa0);
  border: none;
  border-radius: 50%;
  font-size: 24px;
  color: #000;
  cursor: pointer;
  box-shadow: 0 6px 16px rgba(0, 247, 255, 0.4);
  z-index: 1000;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
">
  ğŸ”
</button>


</body>
</html>
